<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <title>åç¼€è¡¨è¾¾å¼ä¸åŸºäºæ ˆVM | manan&#39;s blog ğŸ·</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="åç¼€è¡¨è¾¾å¼ ğŸ”—ç®—æœ¯è¿ç®—è¡¨è¾¾å¼æœ‰ä¸‰ç§å½¢å¼ï¼Œåˆ†åˆ«ä¸ºâ€œä¸­ç¼€è¡¨è¾¾å¼â€ï¼Œâ€œåç¼€è¡¨è¾¾å¼â€å’Œâ€œå‰ç¼€è¡¨è¾¾å¼â€ã€‚ ä¸­ç¼€è¡¨è¾¾å¼æ˜¯è®©æ•°æ®ç»“åˆåœ¨ç®—ç¬¦çš„ä¸¤ä¾§ï¼Œä¾‹å¦‚a * (b &#43;">
<meta name="generator" content="Hugo 0.89.0-DEV" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

 
    



  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>é¦–é¡µ</a>
	
	<a href="/posts">å½’æ¡£</a>
	<a href="/tags">æ ‡ç­¾</a>
	<a href="/about">å…³äº</a>

	
		<a href="https://www.zhihu.com/people/manan333">çŸ¥ä¹</a>
	
		<a href="https://space.bilibili.com/199622112">Bç«™</a>
	

	
	  <a class="button" href="/index.xml">è®¢é˜…</a>
	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">åç¼€è¡¨è¾¾å¼ä¸åŸºäºæ ˆVM</h1>

    <div class="tip">
        <time datetime="2021-09-19 16:02:13 &#43;0800 CST">2021å¹´09æœˆ19æ—¥</time>
        <span class="split">
          Â·
        </span>
        <span>
          1484å­—
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          3åˆ†é’Ÿ
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#åç¼€è¡¨è¾¾å¼">åç¼€è¡¨è¾¾å¼</a></li>
    <li><a href="#åç¼€è¡¨è¾¾å¼çš„è®¡ç®—">åç¼€è¡¨è¾¾å¼çš„è®¡ç®—</a></li>
    <li><a href="#åç¼€è¡¨è¾¾å¼åœ¨jvm-bytecodeä¸­çš„ä½“ç°">åç¼€è¡¨è¾¾å¼åœ¨JVM Bytecodeä¸­çš„ä½“ç°</a></li>
    <li><a href="#é™„å½•aä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼java">é™„å½•Aï¼šä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼ï¼ˆJavaï¼‰</a></li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <h2 id="åç¼€è¡¨è¾¾å¼">åç¼€è¡¨è¾¾å¼ <a href="#%e5%90%8e%e7%bc%80%e8%a1%a8%e8%be%be%e5%bc%8f" class="anchor">ğŸ”—</a></h2><p>ç®—æœ¯è¿ç®—è¡¨è¾¾å¼æœ‰ä¸‰ç§å½¢å¼ï¼Œåˆ†åˆ«ä¸ºâ€œä¸­ç¼€è¡¨è¾¾å¼â€ï¼Œâ€œåç¼€è¡¨è¾¾å¼â€å’Œâ€œå‰ç¼€è¡¨è¾¾å¼â€ã€‚</p>
<p>ä¸­ç¼€è¡¨è¾¾å¼æ˜¯è®©æ•°æ®ç»“åˆåœ¨ç®—ç¬¦çš„ä¸¤ä¾§ï¼Œä¾‹å¦‚<code>a * (b + c) - d</code>ã€‚è¿™ç§è¡¨è¾¾å¼ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨æœ€å¤šï¼Œæœ€ç¬¦åˆäººç±»æ€è€ƒæ–¹å¼çš„ç®—æœ¯è¿ç®—è¡¨è¾¾å½¢å¼ã€‚</p>
<p>å‰ç¼€è¡¨è¾¾å¼ä¸åç¼€è¡¨è¾¾å¼ç±»ä¼¼ï¼Œåç¼€è¡¨è¾¾å¼æ˜¯å°†ç®—ç¬¦ç½®äºæ•°æ®ä¹‹åï¼Œä¾‹å¦‚<code>a b c + * d -</code>ã€‚å‰ç¼€è¡¨è¾¾å¼æ˜¯å°†è¿ç®—ç¬¦ç½®äºæ•°æ®ä¹‹å‰ï¼Œä¾‹å¦‚<code>+ * a b c - d</code>ã€‚</p>
<p>æœ€å¸¸ä½¿ç”¨çš„ä¸­ç¼€è¡¨è¾¾å¼å¯ä»¥é€šè¿‡ä¸€å®šçš„ç®—æ³•è½¬æ¢ä¸ºåç¼€æˆ–è€…å‰ç¼€è¡¨è¾¾å¼ã€‚</p>
<p>é€šè¿‡è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œåç¼€è¡¨è¾¾å¼åœ¨è®¡ç®—æ—¶æ˜¯<strong>æœ‰åºçš„</strong>ï¼Œæ‰€è°“<strong>æœ‰åº</strong>å°±æ˜¯æˆ‘ä»¬åªéœ€éå†æ•´ä¸ªè¡¨è¾¾å¼å°±èƒ½å¾—åˆ°è¡¨è¾¾å¼çš„ç»“æœï¼Œæ— éœ€è€ƒè™‘è¿ç®—ç¬¦ä¹‹é—´çš„ä¼˜å…ˆçº§é¡ºåºï¼ˆä¸­ç¼€è¡¨è¾¾å¼æ˜¾ç„¶éœ€è¦è€ƒè™‘ç®—ç¬¦ä¹‹é—´çš„ä¼˜å…ˆçº§é¡ºåºï¼Œè€Œåç¼€è¡¨è¾¾å¼æ˜¯å·²ç»æŒ‰ç…§è¿ç®—ç¬¦é¡ºåºè¿›è¡Œæ’å¥½åºçš„è¡¨è¾¾å¼åºåˆ—ï¼‰ã€‚</p>
<h2 id="åç¼€è¡¨è¾¾å¼çš„è®¡ç®—">åç¼€è¡¨è¾¾å¼çš„è®¡ç®— <a href="#%e5%90%8e%e7%bc%80%e8%a1%a8%e8%be%be%e5%bc%8f%e7%9a%84%e8%ae%a1%e7%ae%97" class="anchor">ğŸ”—</a></h2><ul>
<li>ç®—æ³•å‡†å¤‡</li>
</ul>
<ol>
<li>
<p>åç¼€è¡¨è¾¾å¼</p>
</li>
<li>
<p>æ•°æ®æ ˆ</p>
</li>
</ol>
<ul>
<li>ç®—æ³•é˜è¿°</li>
</ul>
<ol>
<li>
<p>éå†åç¼€è¡¨è¾¾å¼å­—ç¬¦ä¸²</p>
</li>
<li>
<p>å¦‚æœå­—ç¬¦ä¸²æ˜¯æ•°å­—ï¼Œè½¬æ¢ä¸ºæ•°å­—å¹¶å‹å…¥æ•°æ®æ ˆ</p>
</li>
<li>
<p>å¦‚æœæ˜¯æ”¯æŒçš„ç®—ç¬¦ï¼Œæ ¹æ®ç®—ç¬¦çš„æ•°æ®ç»“åˆæ€§ï¼ˆä¸€å…ƒç®—ç¬¦ç»“åˆä¸€ä¸ªæ•°æ®ï¼ŒäºŒå…ƒç®—ç¬¦ç»“åˆä¸¤ä¸ªæ•°æ®ï¼Œä¸è€ƒè™‘ç®—ç¬¦çš„å·¦ç»“åˆå’Œå³ç»“åˆï¼‰ä»æ ˆä¸­å¼¹å‡ºæŒ‡å®šæ•°é‡çš„æ•°æ®</p>
</li>
<li>
<p>å°†å¼¹å‡ºçš„æ•°æ®æŒ‰ç…§ç®—ç¬¦è®¡ç®—è§„åˆ™è¿›è¡Œè®¡ç®—ï¼Œå¹¶é‡æ–°å‹å…¥æ ˆ</p>
</li>
</ol>
<ul>
<li>Javaä»£ç å®ç°</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">ArrayDeque<span style="color:#666">&lt;</span>Double<span style="color:#666">&gt;</span> operatorNumberStack <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> ArrayDeque<span style="color:#666">&lt;&gt;();</span>
<span style="color:#a2f;font-weight:bold">for</span> <span style="color:#666">(</span>String token <span style="color:#666">:</span> tokenStream<span style="color:#666">)</span> <span style="color:#666">{</span>
    <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>isSupportedOperator<span style="color:#666">(</span>token<span style="color:#666">.</span><span style="color:#b44">charAt</span><span style="color:#666">(</span>0<span style="color:#666">)))</span> <span style="color:#666">{</span>
        <span style="color:#0b0;font-weight:bold">double</span> a<span style="color:#666">,</span> b <span style="color:#666">=</span> 0<span style="color:#666">.</span><span style="color:#b44">0D</span><span style="color:#666">;</span>
        <span style="color:#a2f;font-weight:bold">switch</span> <span style="color:#666">(</span>token<span style="color:#666">)</span> <span style="color:#666">{</span>
            <span style="color:#a2f;font-weight:bold">case</span> <span style="color:#b44">&#34;+&#34;</span><span style="color:#666">:</span>
                a <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                b <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>b <span style="color:#666">+</span> a<span style="color:#666">);</span>
                <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
            <span style="color:#a2f;font-weight:bold">case</span> <span style="color:#b44">&#34;-&#34;</span><span style="color:#666">:</span>
                a <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                b <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>b <span style="color:#666">-</span> a<span style="color:#666">);</span>
                <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
            <span style="color:#a2f;font-weight:bold">case</span> <span style="color:#b44">&#34;*&#34;</span><span style="color:#666">:</span>
                a <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                b <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>b <span style="color:#666">*</span> a<span style="color:#666">);</span>
                <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
            <span style="color:#a2f;font-weight:bold">case</span> <span style="color:#b44">&#34;/&#34;</span><span style="color:#666">:</span>
                a <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                b <span style="color:#666">=</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>b <span style="color:#666">/</span> a<span style="color:#666">);</span>
                <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
            <span style="color:#a2f;font-weight:bold">default</span><span style="color:#666">:</span>
                <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
        <span style="color:#666">}</span>
    <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#666">{</span>
        operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>Double<span style="color:#666">.</span><span style="color:#b44">valueOf</span><span style="color:#666">(</span>token<span style="color:#666">));</span>
    <span style="color:#666">}</span>
<span style="color:#666">}</span>
<span style="color:#a2f;font-weight:bold">return</span> operatorNumberStack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
</code></pre></div><h2 id="åç¼€è¡¨è¾¾å¼åœ¨jvm-bytecodeä¸­çš„ä½“ç°">åç¼€è¡¨è¾¾å¼åœ¨JVM Bytecodeä¸­çš„ä½“ç° <a href="#%e5%90%8e%e7%bc%80%e8%a1%a8%e8%be%be%e5%bc%8f%e5%9c%a8jvm-bytecode%e4%b8%ad%e7%9a%84%e4%bd%93%e7%8e%b0" class="anchor">ğŸ”—</a></h2><p>åœ¨JVMæŠ½è±¡å±‚é¢ï¼ŒJVMè¿è¡Œæ˜¯ä¸å¯„å­˜å™¨æ— å…³ï¼Œå› ä¸ºJVMè¢«è®¾è®¡ä¸ºä¸€ç§åŸºäºæ ˆçš„è™šæ‹Ÿæœºã€‚</p>
<p>JVMæ‰€æœ‰çš„æ•°æ®è¿ç®—éƒ½åœ¨æ ˆä¸­è¿›è¡Œï¼Œåœ¨ä¸€ä¸ªJVM Stack Frameä¸­æœ‰æ“ä½œæ•°æ ˆï¼ˆå­˜æ”¾æ•°æ®çš„æ ˆï¼‰ï¼Œæœ¬åœ°å˜é‡è¡¨ï¼ˆå­˜æ”¾å‚æ•°ï¼Œå±€éƒ¨å˜é‡å’Œä¸´æ—¶å˜é‡ï¼‰ä¸¤ç§å­˜æ”¾æ•°æ®çš„ç»“æ„ã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢ä¸€æ®µJavaä»£ç å’Œç¼–è¯‘ä¸ºBytecodeä¹‹åçš„æŒ‡ä»¤åºåˆ—ã€‚</p>
<hr>
<p>Java Code</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#0b0;font-weight:bold">int</span> a <span style="color:#666">=</span> 1<span style="color:#666">;</span>
<span style="color:#0b0;font-weight:bold">int</span> b <span style="color:#666">=</span> 2<span style="color:#666">;</span>
<span style="color:#0b0;font-weight:bold">int</span> c <span style="color:#666">=</span> 3<span style="color:#666">;</span>
<span style="color:#0b0;font-weight:bold">int</span> d <span style="color:#666">=</span> 4<span style="color:#666">;</span>
<span style="color:#0b0;font-weight:bold">int</span> e <span style="color:#666">=</span> a <span style="color:#666">*</span> <span style="color:#666">(</span>b <span style="color:#666">+</span> c<span style="color:#666">)</span> <span style="color:#666">-</span>d<span style="color:#666">;</span>
System<span style="color:#666">.</span><span style="color:#b44">out</span><span style="color:#666">.</span><span style="color:#b44">println</span><span style="color:#666">(</span>e<span style="color:#666">);</span>
</code></pre></div><hr>
<p>ByteCode</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">iconst_1 # å°†æ•´æ•°1å‹å…¥æ“ä½œæ•°æ ˆ
istore_1 # å¼¹å‡ºæ ˆé¡¶æ•°æ®å¹¶æ”¾å…¥æœ¬åœ°å˜é‡è¡¨ç´¢å¼•ä¸º1çš„ä½ç½®ï¼ˆå˜é‡aï¼‰
iconst_2 # å°†æ•´æ•°2å‹å…¥æ“ä½œæ•°æ ˆ
istore_2 # å¼¹å‡ºæ ˆé¡¶æ•°æ®å¹¶æ”¾å…¥æœ¬åœ°å˜é‡è¡¨ç´¢å¼•ä¸º2çš„ä½ç½®ï¼ˆå˜é‡bï¼‰
iconst_3 # å°†æ•´æ•°3å‹å…¥æ“ä½œæ•°æ ˆ 
istore_3 # å¼¹å‡ºæ ˆé¡¶æ•°æ®å¹¶æ”¾å…¥æœ¬åœ°å˜é‡è¡¨ç´¢å¼•ä¸º3çš„ä½ç½®ï¼ˆå˜é‡cï¼‰
iconst_4 # å°†æ•´æ•°4å‹å…¥æ“ä½œæ•°æ ˆ
istore 4 # å¼¹å‡ºæ ˆé¡¶æ•°æ®å¹¶æ”¾å…¥æœ¬åœ°å˜é‡è¡¨ç´¢å¼•ä¸º3çš„ä½ç½®ï¼ˆå˜é‡dï¼‰
iload_1  # ä»æœ¬åœ°å˜é‡è¡¨åŠ è½½ç´¢å¼•ä¸º1çš„æ•°æ®è‡³æ“ä½œæ•°æ ˆ ï¼ˆå˜é‡aï¼‰
iload_2  # ä»æœ¬åœ°å˜é‡è¡¨åŠ è½½ç´¢å¼•ä¸º1çš„æ•°æ®è‡³æ“ä½œæ•°æ ˆ ï¼ˆå˜é‡bï¼‰
iload_3  # ä»æœ¬åœ°å˜é‡è¡¨åŠ è½½ç´¢å¼•ä¸º1çš„æ•°æ®è‡³æ“ä½œæ•°æ ˆ ï¼ˆå˜é‡cï¼‰
iadd     # ä»æ“ä½œæ•°æ ˆå¼¹å‡ºä¸¤ä¸ªæ•´æ•°ï¼Œç›¸åŠ ï¼Œç»“æœå…¥æ ˆ
imul     # ä»æ“ä½œæ•°æ ˆå¼¹å‡ºä¸¤ä¸ªæ•´æ•°ï¼Œç›¸ä¹˜ï¼Œç»“æœå…¥æ ˆ
iload 4  # ä»æœ¬åœ°å˜é‡è¡¨åŠ è½½ç´¢å¼•ä¸º1çš„æ•°æ®è‡³æ“ä½œæ•°æ ˆ ï¼ˆå˜é‡dï¼‰
isub     # ä»æ“ä½œæ•°æ ˆå¼¹å‡ºä¸¤ä¸ªæ•´æ•°ï¼Œç›¸å‡ï¼Œç»“æœå…¥æ ˆ
istore 5 # ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ªæ•´æ•°ï¼Œå­˜å…¥æœ¬åœ°å˜é‡è¡¨ç´¢å¼•ä¸º5çš„ä½ç½®
</code></pre></div><p>ä»ç¼–è¯‘ç”Ÿæˆçš„å­—èŠ‚ç æ¥çœ‹ï¼Œä¸Šè¿°Javaä»£ç çš„è¿ç®—åœ¨å­—èŠ‚ç å±‚é¢å®Œå…¨æ˜¯æŒ‰ç…§åç¼€è¡¨è¾¾å¼çš„å½¢å¼å»è®¡ç®—ï¼Œå³<code>a b c + * d -</code>ã€‚</p>
<p>è¿™æ­£æ˜¯å¾—ç›Šäºåç¼€è¡¨è¾¾å¼çš„æœ‰åºæ€§ä¸æŒ‡ä»¤æ‰§è¡Œçš„æœ‰åºæ€§æ˜¯å®Œç¾å¥‘åˆçš„ï¼ˆä»£ç æ‰§è¡Œé€šè¿‡PCç¨‹åºè®¡æ•°å™¨å°†æ’å¸ƒåœ¨å†…å­˜ä¸­çš„æŒ‡ä»¤æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼‰æ‰€ä»¥åŸºäºæ ˆçš„è™šæ‹Ÿæœºè®¾è®¡ä¸­åœ¨è®¾è®¡æ•°æ®è¿ç®—æ—¶ä¹Ÿä¼šå‚ç…§è¿™ç§å½¢å¼è¿›è¡Œã€‚</p>
<h2 id="é™„å½•aä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼java">é™„å½•Aï¼šä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼ï¼ˆJavaï¼‰ <a href="#%e9%99%84%e5%bd%95a%e4%b8%ad%e7%bc%80%e8%a1%a8%e8%be%be%e5%bc%8f%e8%bd%ac%e5%90%8e%e7%bc%80%e8%a1%a8%e8%be%be%e5%bc%8fjava" class="anchor">ğŸ”—</a></h2><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a2f;font-weight:bold">public</span> <span style="color:#a2f;font-weight:bold">static</span> String <span style="color:#00a000">me2pe</span><span style="color:#666">(</span>String expr<span style="color:#666">)</span> <span style="color:#666">{</span>
    expr <span style="color:#666">=</span> expr <span style="color:#666">+</span> <span style="color:#b44">&#39;)&#39;</span><span style="color:#666">;</span>
    <span style="color:#a2f;font-weight:bold">final</span> ArrayDeque<span style="color:#666">&lt;</span>Character<span style="color:#666">&gt;</span> stack <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> ArrayDeque<span style="color:#666">&lt;&gt;();</span>
    stack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span><span style="color:#b44">&#39;(&#39;</span><span style="color:#666">);</span>
    <span style="color:#a2f;font-weight:bold">final</span> StringBuilder buffer <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">new</span> StringBuilder<span style="color:#666">();</span>
    <span style="color:#a2f;font-weight:bold">for</span> <span style="color:#666">(</span><span style="color:#0b0;font-weight:bold">int</span> i <span style="color:#666">=</span> 0<span style="color:#666">,</span> len <span style="color:#666">=</span> expr<span style="color:#666">.</span><span style="color:#b44">length</span><span style="color:#666">();</span> i <span style="color:#666">&lt;</span> len<span style="color:#666">;)</span> <span style="color:#666">{</span>
        <span style="color:#a2f;font-weight:bold">final</span> <span style="color:#0b0;font-weight:bold">char</span> token <span style="color:#666">=</span> expr<span style="color:#666">.</span><span style="color:#b44">charAt</span><span style="color:#666">(</span>i<span style="color:#666">);</span>
        <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>Character<span style="color:#666">.</span><span style="color:#b44">isDigit</span><span style="color:#666">(</span>token<span style="color:#666">))</span> <span style="color:#666">{</span>
            NextIndexAndResult r <span style="color:#666">=</span> nextRealNumberString<span style="color:#666">(</span>expr<span style="color:#666">,</span> i<span style="color:#666">);</span>
            i <span style="color:#666">=</span> r<span style="color:#666">.</span><span style="color:#b44">nextIndex</span><span style="color:#666">;</span>
            buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span>r<span style="color:#666">.</span><span style="color:#b44">result</span><span style="color:#666">);</span>
            buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span><span style="color:#b44">&#39; &#39;</span><span style="color:#666">);</span>
        <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>isSupportedOperator<span style="color:#666">(</span>token<span style="color:#666">))</span> <span style="color:#666">{</span>
            <span style="color:#080;font-style:italic">// check operator priority
</span><span style="color:#080;font-style:italic"></span>            <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>operatorPriorityTable<span style="color:#666">.</span><span style="color:#b44">get</span><span style="color:#666">(</span>token<span style="color:#666">)</span> <span style="color:#666">&gt;</span> operatorPriorityTable<span style="color:#666">.</span><span style="color:#b44">get</span><span style="color:#666">(</span>stack<span style="color:#666">.</span><span style="color:#b44">peek</span><span style="color:#666">()))</span> <span style="color:#666">{</span>
                stack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>token<span style="color:#666">);</span>
                i <span style="color:#666">++;</span>
            <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#666">{</span>
                <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>token <span style="color:#666">==</span> <span style="color:#b44">&#39;)&#39;</span><span style="color:#666">)</span> <span style="color:#666">{</span>
                    <span style="color:#080;font-style:italic">// pop until &#39;(&#39;
</span><span style="color:#080;font-style:italic"></span>                    <span style="color:#a2f;font-weight:bold">for</span> <span style="color:#666">(;;)</span> <span style="color:#666">{</span>
                        <span style="color:#0b0;font-weight:bold">char</span> t <span style="color:#666">=</span> stack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">();</span>
                        <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>t <span style="color:#666">==</span> <span style="color:#b44">&#39;(&#39;</span><span style="color:#666">)</span> <span style="color:#a2f;font-weight:bold">break</span><span style="color:#666">;</span>
                        buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span>t<span style="color:#666">);</span>
                        buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span><span style="color:#b44">&#39; &#39;</span><span style="color:#666">);</span>
                    <span style="color:#666">}</span>
                    i<span style="color:#666">++;</span>
                <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#a2f;font-weight:bold">if</span> <span style="color:#666">(</span>token <span style="color:#666">==</span> <span style="color:#b44">&#39;(&#39;</span><span style="color:#666">)</span> <span style="color:#666">{</span>
                    stack<span style="color:#666">.</span><span style="color:#b44">push</span><span style="color:#666">(</span>token<span style="color:#666">);</span>
                    i<span style="color:#666">++;</span>
                <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#666">{</span>
                    buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span>stack<span style="color:#666">.</span><span style="color:#b44">pop</span><span style="color:#666">());</span>
                    buffer<span style="color:#666">.</span><span style="color:#b44">append</span><span style="color:#666">(</span><span style="color:#b44">&#39; &#39;</span><span style="color:#666">);</span>
                <span style="color:#666">}</span>
            <span style="color:#666">}</span>
        <span style="color:#666">}</span> <span style="color:#a2f;font-weight:bold">else</span> <span style="color:#666">{</span>
            <span style="color:#080;font-style:italic">// other tokens
</span><span style="color:#080;font-style:italic"></span>            i<span style="color:#666">++;</span>
        <span style="color:#666">}</span>
    <span style="color:#666">}</span>
    <span style="color:#a2f;font-weight:bold">return</span> buffer<span style="color:#666">.</span><span style="color:#b44">toString</span><span style="color:#666">();</span>
<span style="color:#666">}</span>
</code></pre></div><p>è·å–å®Œæ•´ä»£ç è¯·è®¿é—®Githubä»“åº“ï¼š<a href="https://github.com/mananBC1st/JavaLeetcode" target="_blank" rel="noopener">https://github.com/mananBC1st/JavaLeetcode</a></p>

    </div>

    
        <div class="tags">
            
                <a href="/tags/%E7%AE%97%E6%B3%95">ç®—æ³•</a>
            
                <a href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB">æ‚ä¸ƒæ‚å…«</a>
            
        </div>
    
    
    
  <div id="comment">
    
    
  </div>


</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
        ç‰ˆæƒå£°æ˜ï¼šç½²å-éå•†ä¸šä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0 å›½é™…(BY-NC-SA 3.0)
    
    </div>

    
      <div class="powerby">
        Powered by <a href='http://www.gohugo.io/'>Hugo</a> Theme By <a href='https://github.com/nodejh/hugo-theme-cactus-plus'>nodejh</a>
      </div>
    
</footer>



  </body>
</html>
